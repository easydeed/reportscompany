{# =============================================================================
   CLASSIC THEME
   Timeless, trustworthy, traditional elegance
   
   Typography: Playfair Display (display) + Source Sans Pro (body)
   Colors: Deep navy + warm tan
   Style: Refined serif typography, classic layouts, understated luxury
   ============================================================================= #}

{% extends '_base/base.jinja2' %}

{% block fonts %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;900&family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
{% endblock %}

{% block theme_styles %}
  :root {
    /* Classic Theme Colors - Primary is customizable */
    --color-primary: {{ theme_color | default('#1B365D', true) }};
    --color-primary-light: #2C4A7C;
    --color-accent: #8B7355;
    --color-accent-light: #A89070;
    --color-background: #FFFFFF;
    --color-surface: #FDFBF7;
    --color-text: #1B365D;
    --color-text-muted: #5C6670;
    --color-border: #E0DCD4;
    
    /* Typography */
    --font-display: 'Playfair Display', Georgia, serif;
    --font-body: 'Source Sans Pro', system-ui, sans-serif;
    
    /* Classic-specific */
    --radius-sm: 4px;
    --radius-md: 6px;
    --radius-lg: 8px;
    
    --shadow-sm: 0 2px 6px rgba(27, 54, 93, 0.06);
    --shadow-md: 0 4px 16px rgba(27, 54, 93, 0.1);
    --shadow-lg: 0 8px 30px rgba(27, 54, 93, 0.12);
  }
  
  /* ==========================================================================
     CLASSIC: Cover Page
     ========================================================================== */
  
  .page-cover {
    background: var(--color-surface);
  }
  
  .page-cover .cover-bg {
    position: absolute;
    inset: 0;
    background: 
      linear-gradient(180deg, 
        rgba(27, 54, 93, 0.0) 0%,
        rgba(27, 54, 93, 0.15) 50%,
        rgba(27, 54, 93, 0.85) 100%
      ){% if images.hero %},
      url('{{ images.hero }}') center/cover no-repeat{% endif %};
  }
  
  /* Top accent bar - two-tone */
  .page-cover::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 8px;
    background: linear-gradient(90deg, var(--color-primary) 0%, var(--color-primary) 60%, var(--color-accent) 60%);
    z-index: 10;
  }
  
  /* Branding header */
  .page-cover .cover-branding-header {
    position: absolute;
    top: var(--page-margin);
    left: var(--page-margin);
    right: var(--page-margin);
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 5;
  }
  
  .page-cover .report-badge {
    background: var(--color-primary);
    color: white;
    padding: 8px 20px;
    font-family: var(--font-body);
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 2px;
    text-transform: uppercase;
  }
  
  /* Main content area */
  .page-cover .cover-content {
    position: absolute;
    bottom: 140px;
    left: var(--page-margin);
    right: var(--page-margin);
    z-index: 5;
  }
  
  .page-cover .cover-property-type {
    font-family: var(--font-body);
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--color-accent-light);
    margin-bottom: 16px;
  }
  
  .page-cover .cover-address {
    font-family: var(--font-display);
    font-size: 48px;
    font-weight: 700;
    line-height: 1.1;
    color: white;
    margin-bottom: 12px;
  }
  
  .page-cover .cover-location {
    font-family: var(--font-body);
    font-size: 18px;
    font-weight: 400;
    color: rgba(255,255,255,0.85);
    letter-spacing: 0.5px;
  }
  
  .page-cover .cover-accent-line {
    width: 60px;
    height: 3px;
    background: var(--color-accent);
    margin: 28px 0;
  }
  
  .page-cover .property-stats {
    margin-top: 20px;
  }
  
  .page-cover .stat-value {
    color: white;
    font-size: 26px;
    font-weight: 600;
  }
  
  .page-cover .stat-label {
    color: rgba(255,255,255,0.65);
    font-family: var(--font-body);
  }
  
  /* Footer override for cover */
  .page-cover .cover-footer {
    height: 110px;
    padding: 0 var(--page-margin);
    border-top: 1px solid var(--color-border);
    background: white;
  }
  
  .page-cover .cover-agent-photo {
    border-color: var(--color-accent);
    width: 64px;
    height: 64px;
  }
  
  .page-cover .cover-agent-name {
    font-family: var(--font-display);
    font-size: 20px;
    font-weight: 600;
  }
  
  /* ==========================================================================
     CLASSIC: Page Header Overrides
     ========================================================================== */
  
  .page-header {
    border-bottom: 1px solid var(--color-border);
    padding-bottom: var(--space-md);
  }
  
  .page-header::after {
    content: '';
    display: block;
    width: 60px;
    height: 3px;
    background: var(--color-accent);
    margin-top: var(--space-md);
  }
  
  .page-title {
    font-size: 34px;
    font-weight: 700;
    letter-spacing: -0.5px;
  }
  
  .page-header-accent {
    display: none;
  }
  
  /* ==========================================================================
     CLASSIC: Contents Page
     ========================================================================== */
  
  .page-contents .contents-item {
    border-bottom: 1px dotted var(--color-border);
    padding: var(--space-lg) 0;
  }
  
  .page-contents .contents-number {
    font-family: var(--font-display);
    font-size: 24px;
    font-weight: 700;
    color: var(--color-primary);
    min-width: 50px;
  }
  
  .page-contents .contents-title {
    font-family: var(--font-display);
    font-size: 20px;
    font-weight: 500;
  }
  
  /* ==========================================================================
     CLASSIC: Data Tables
     ========================================================================== */
  
  .data-table {
    border: 1px solid var(--color-border);
  }
  
  .data-table tr:nth-child(even) {
    background: var(--color-surface);
  }
  
  .data-table td {
    padding: 14px 18px;
    border-bottom: 1px solid var(--color-border);
  }
  
  .data-table tr:last-child td {
    border-bottom: none;
  }
  
  .table-title {
    background: var(--color-surface);
    color: var(--color-primary);
    padding: 14px 18px;
    border: 1px solid var(--color-border);
    border-bottom: none;
    font-family: var(--font-display);
    font-weight: 600;
    letter-spacing: 0;
    text-transform: none;
    font-size: 16px;
  }
  
  /* ==========================================================================
     CLASSIC: Comp Cards
     ========================================================================== */
  
  .comp-card {
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-sm);
  }
  
  .comp-card-header {
    background: var(--color-primary);
    padding: 14px var(--space-md);
  }
  
  .comp-number {
    font-family: var(--font-display);
  }
  
  .comp-price {
    font-family: var(--font-display);
    font-size: 18px;
    font-weight: 700;
  }
  
  .comp-address {
    font-family: var(--font-display);
    font-weight: 600;
    font-size: 14px;
  }
  
  .comp-image {
    height: 170px;
  }
  
  /* ==========================================================================
     CLASSIC: Analysis Summary
     ========================================================================== */
  
  .analysis-summary {
    background: white;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-sm);
  }
  
  .range-value {
    font-family: var(--font-display);
    font-weight: 700;
  }
  
  .range-median .range-value {
    color: var(--color-primary);
    font-size: 24px;
  }
  
  .analysis-stat-value {
    font-family: var(--font-display);
    color: var(--color-primary);
  }
  
  /* ==========================================================================
     CLASSIC: Map Card
     ========================================================================== */
  
  .map-card {
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-sm);
  }
  
  .map-card-header {
    background: var(--color-surface);
    font-family: var(--font-display);
    font-weight: 600;
    letter-spacing: 0;
    text-transform: none;
    font-size: 16px;
  }
  
  .map-card-image {
    height: 440px;
  }
  
  /* ==========================================================================
     CLASSIC: Price Range
     ========================================================================== */
  
  .price-range-track {
    height: 10px;
    background: linear-gradient(90deg, 
      var(--color-surface) 0%, 
      var(--color-accent) 50%,
      var(--color-surface) 100%
    );
    border-radius: var(--radius-full);
    border: 1px solid var(--color-border);
  }
  
  .price-range-marker-label {
    background: var(--color-primary);
    font-family: var(--font-display);
    font-size: 13px;
    padding: 6px 12px;
    border-radius: var(--radius-sm);
  }
  
  /* Range comps list */
  .range-comps-list {
    margin-top: var(--space-xl);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    overflow: hidden;
  }
  
  .range-comp-item {
    display: flex;
    justify-content: space-between;
    padding: var(--space-md) var(--space-lg);
    border-bottom: 1px solid var(--color-border);
  }
  
  .range-comp-item:last-child {
    border-bottom: none;
  }
  
  .range-comp-item:nth-child(even) {
    background: var(--color-surface);
  }
  
  .range-comp-address {
    font-family: var(--font-body);
    font-size: 14px;
    font-weight: 600;
  }
  
  .range-comp-price {
    font-family: var(--font-display);
    font-size: 16px;
    font-weight: 700;
    color: var(--color-primary);
  }
  
  /* ==========================================================================
     CLASSIC: Footer Overrides
     ========================================================================== */
  
  .page-footer {
    border-top: 1px solid var(--color-border);
  }
  
  .page-footer::before {
    content: '';
    position: absolute;
    top: -3px;
    left: 0;
    width: 60px;
    height: 3px;
    background: var(--color-accent);
  }
  
  .footer-agent-name {
    font-family: var(--font-display);
    font-weight: 600;
  }
  
  /* V0 overrides — Classic */
  .section-title {
    font-family: var(--font-display);
    letter-spacing: 0.5px;
  }
  
  .comparison-header {
    background: var(--color-primary);
  }

  /* ==========================================================================
     CLASSIC: Internal Page Accents — Theme personality on pages 2-7
     ========================================================================== */

  /* Top accent bar — two-tone like cover */
  .page-contents::before,
  .page-aerial::before,
  .page-property::before,
  .page-analysis::before,
  .page-comparables::before,
  .page-range::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 5px;
    background: linear-gradient(90deg, var(--color-primary) 0%, var(--color-primary) 60%, var(--color-accent) 60%);
    z-index: 10;
  }

  /* Key stats bar */
  .key-stats-bar {
    background: var(--color-primary);
  }

  /* Analysis summary with warm accent */
  .analysis-summary {
    border-top: 2px solid var(--color-accent);
  }

  /* Range container accent */
  .range-bar-container {
    border-top: 2px solid var(--color-accent);
  }

  /* Stats cards accent */
  .range-stat-card {
    border-top: 2px solid var(--color-accent);
  }

  /* Market insight */
  .market-insight {
    border-left: 3px solid var(--color-accent);
    background: var(--color-surface);
  }

  /* Contents sidebar accent */
  .page-contents .contents-sidebar-accent {
    background: var(--color-accent);
    opacity: 0.5;
  }

  /* ==========================================================================
     CLASSIC V0 ORIGINAL: Analysis Page (p5) — Transplanted from commit 8dbec7b
     ========================================================================== */

  /* Full-bleed page banner for pages 5/6/7 — positioned at absolute top of .page */
  .classic-v0-header {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    z-index: 5;
    background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
    padding: 20px 25px;
    border-bottom: 3px solid var(--color-accent);
  }

  /* Push page-content below the full-bleed header on pages 5, 6, 7 */
  .page-analysis .page-content,
  .page-comparables .page-content,
  .page-range .page-content {
    top: 1.2in;
  }

  .classic-v0-header .header-label {
    font-family: var(--font-body);
    font-size: 11px;
    letter-spacing: 0.22em;
    text-transform: uppercase;
    color: var(--color-accent-light);
    margin-bottom: 8px;
    font-weight: 600;
  }

  .classic-v0-header .header-title {
    font-family: var(--font-display);
    font-size: 40px;
    font-weight: 700;
    color: white;
    margin: 0;
    letter-spacing: -0.3px;
  }

  .classic-v0-p5 .analysis-chart {
    background: linear-gradient(180deg, var(--color-surface) 0%, #fff 100%);
    border: 1px solid var(--color-border);
    border-top: 3px solid var(--color-accent);
    padding: 25px;
    margin-bottom: 25px;
    box-shadow: var(--shadow-sm);
    border-radius: var(--radius-md);
  }

  .classic-v0-p5 .chart-title {
    font-family: var(--font-display);
    font-size: 14px;
    font-weight: 700;
    color: var(--color-primary);
    margin-bottom: 20px;
    text-align: center;
    letter-spacing: 0.3px;
  }

  .classic-v0-p5 .chart-bars {
    display: flex;
    align-items: flex-end;
    justify-content: space-around;
    height: 350px;
    padding: 0 30px;
    border-bottom: 2px solid var(--color-primary);
  }

  .classic-v0-p5 .chart-bar-wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }

  .classic-v0-p5 .chart-bar {
    width: 55px;
    background: linear-gradient(180deg, var(--color-primary-light) 0%, var(--color-primary) 100%);
    box-shadow: 0 4px 12px rgba(27, 54, 93, 0.18);
    border-radius: 3px 3px 0 0;
  }

  .classic-v0-p5 .chart-bar-label {
    font-size: 11px;
    color: var(--color-text-muted);
    font-weight: 600;
  }

  .classic-v0-p5 .analysis-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
    border: 1px solid var(--color-border);
    border-radius: 10px;
    overflow: hidden;
  }

  .classic-v0-p5 .analysis-table thead {
    background: var(--color-primary);
    color: white;
  }

  .classic-v0-p5 .analysis-table th {
    padding: 14px 12px;
    text-align: left;
    font-weight: 700;
    font-size: 12px;
  }

  .classic-v0-p5 .analysis-table tbody tr:nth-child(even) {
    background: var(--color-surface);
  }

  .classic-v0-p5 .analysis-table tbody tr {
    border-bottom: 1px solid var(--color-border);
  }

  .classic-v0-p5 .analysis-table td {
    padding: 12px;
  }

  .classic-v0-p5 .analysis-table tfoot {
    background: linear-gradient(90deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
    color: var(--color-primary);
    font-weight: 700;
  }

  .classic-v0-p5 .analysis-table tfoot td {
    padding: 14px 12px;
  }

  /* ==========================================================================
     CLASSIC V0 ORIGINAL: Comparables Page (p6) — Transplanted from commit 8dbec7b
     ========================================================================== */

  .classic-v0-p6 .comp-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 25px;
  }

  .classic-v0-p6 .comp-card {
    border: 1px solid var(--color-border);
    border-radius: 10px;
    overflow: hidden;
    box-shadow: var(--shadow-sm);
    border-top: 3px solid var(--color-accent);
  }

  .classic-v0-p6 .comp-card-image {
    height: 220px;
    background: var(--color-text-muted);
    position: relative;
  }

  .classic-v0-p6 .comp-card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .classic-v0-p6 .comp-card-price {
    position: absolute;
    top: 10px;
    left: 10px;
    background: var(--color-primary);
    color: white;
    padding: 6px 14px;
    font-family: var(--font-display);
    font-size: 16px;
    font-weight: 700;
  }

  .classic-v0-p6 .comp-card-body {
    padding: 15px;
    background: white;
  }

  .classic-v0-p6 .comp-card-address {
    font-family: var(--font-display);
    font-size: 14px;
    font-weight: 700;
    color: var(--color-primary);
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .classic-v0-p6 .comp-card-address svg {
    width: 14px;
    height: 14px;
    fill: var(--color-accent);
    flex-shrink: 0;
  }

  .classic-v0-p6 .comp-card-stats {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
  }

  .classic-v0-p6 .comp-stat {
    background: var(--color-surface);
    padding: 10px;
    text-align: center;
  }

  .classic-v0-p6 .comp-stat-label {
    font-size: 10px;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 3px;
  }

  .classic-v0-p6 .comp-stat-value {
    font-size: 13px;
    font-weight: 700;
    color: var(--color-text);
  }

  /* ==========================================================================
     CLASSIC V0 ORIGINAL: Range Page (p7) — Transplanted from commit 8dbec7b
     ========================================================================== */

  .classic-v0-p7 .range-map {
    height: 4.5in;
    background: var(--color-border);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    margin: 25px 0;
    overflow: hidden;
  }

  .classic-v0-p7 .range-map img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .classic-v0-p7 .range-stats {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 15px;
    margin-bottom: 25px;
  }

  .classic-v0-p7 .range-stat {
    background: linear-gradient(160deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
    padding: 24px 15px;
    text-align: center;
    border-radius: 8px;
    border-bottom: 3px solid var(--color-accent);
    box-shadow: var(--shadow-md);
  }

  .classic-v0-p7 .range-stat-num {
    font-family: var(--font-display);
    font-size: 38px;
    font-weight: 900;
    color: white;
    line-height: 1;
  }

  .classic-v0-p7 .range-stat-label {
    font-size: 11px;
    color: var(--color-accent-light);
    text-transform: uppercase;
    letter-spacing: 0.12em;
    margin-top: 10px;
    font-weight: 600;
  }

  .classic-v0-p7 .range-slider {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 10px;
    padding: 25px;
  }

  .classic-v0-p7 .range-slider-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 15px;
  }

  .classic-v0-p7 .range-slider-price {
    font-family: var(--font-display);
    font-size: 22px;
    font-weight: 900;
    color: var(--color-primary);
  }

  .classic-v0-p7 .range-slider-track {
    height: 10px;
    background: linear-gradient(90deg, var(--color-accent-light) 0%, var(--color-accent) 40%, var(--color-primary) 100%);
    border-radius: 5px;
    position: relative;
    margin-bottom: 20px;
  }

  .classic-v0-p7 .range-slider-dot {
    width: 22px;
    height: 22px;
    background: white;
    border: 3px solid var(--color-primary);
    border-radius: 50%;
    position: absolute;
    top: 50%;
    transform: translate(-50%, -50%);
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  }

  .classic-v0-p7 .range-note {
    font-size: 13px;
    line-height: 1.7;
    color: var(--color-text-muted);
    text-align: center;
  }
{% endblock %}

{# =============================================================================
   COVER PAGE OVERRIDE
   ============================================================================= #}
{% block cover %}
<div class="cover-bg"></div>

<div class="cover-branding-header">
  <div class="report-badge">Property Report</div>
  {% if agent.logo_url %}
  <img src="{{ agent.logo_url }}" alt="{{ agent.company_name }}" style="max-height: 50px; max-width: 160px; object-fit: contain;">
  {% else %}
  <span style="font-family: var(--font-display); font-size: 18px; font-weight: 600; color: var(--color-primary);">{{ agent.company_name }}</span>
  {% endif %}
</div>

<div class="cover-content">
  <div class="cover-property-type">{{ property.property_type | default('Single Family Residence') }}</div>
  <h1 class="cover-address">{{ property.street_address }}</h1>
  <p class="cover-location">{{ property.city }}, {{ property.state }} {{ property.zip_code }}</p>
  <div class="cover-accent-line"></div>
  {{ macros.property_stats(property) }}
</div>

{{ macros.cover_agent_block(agent) }}
{% endblock %}

{# =============================================================================
   ANALYSIS PAGE OVERRIDE — Transplanted from V0 original (commit 8dbec7b)
   Navy header + chart with navy bars + analysis table with sky-blue footer
   ============================================================================= #}
{% block analysis %}
<div class="classic-v0-header">
  <div class="header-label">Market Intelligence</div>
  <h2 class="header-title">Area Sales Analysis</h2>
</div>
<div class="page-content classic-v0-p5">
  <div class="analysis-chart">
    <div class="chart-title">Recent Comparable Sales Activity</div>
    <div class="chart-bars">
      {% for comp in comparables[:4] %}
      <div class="chart-bar-wrap">
        <div class="chart-bar" style="height: {{ [40, (comp.sale_price / 8000) | int] | max }}px;"></div>
        <div class="chart-bar-label">{{ comp.sold_date | default('-') }}</div>
      </div>
      {% endfor %}
    </div>
  </div>
  <table class="analysis-table">
    <thead>
      <tr><th>Metric</th><th>Subject</th><th>Low</th><th>Medium</th><th>High</th></tr>
    </thead>
    <tbody>
      <tr><td>Distance (mi)</td><td>{{ stats.piq.distance | default('0') }}</td><td>{{ stats.low.distance | default('-') }}</td><td>{{ stats.medium.distance | default('-') }}</td><td>{{ stats.high.distance | default('-') }}</td></tr>
      <tr><td>Living Area (sf)</td><td>{{ stats.piq.sqft | default('-') }}</td><td>{{ stats.low.sqft | default('-') }}</td><td>{{ stats.medium.sqft | default('-') }}</td><td>{{ stats.high.sqft | default('-') }}</td></tr>
      <tr><td>Price/Sq.Ft.</td><td>{{ stats.piq.price_per_sqft | format_currency }}</td><td>{{ stats.low.price_per_sqft | format_currency }}</td><td>{{ stats.medium.price_per_sqft | format_currency }}</td><td>{{ stats.high.price_per_sqft | format_currency }}</td></tr>
      <tr><td>Year Built</td><td>{{ stats.piq.year_built | default('-') }}</td><td>{{ stats.low.year_built | default('-') }}</td><td>{{ stats.medium.year_built | default('-') }}</td><td>{{ stats.high.year_built | default('-') }}</td></tr>
      <tr><td>Lot Size (sf)</td><td>{{ stats.piq.lot_size | format_number }}</td><td>{{ stats.low.lot_size | format_number }}</td><td>{{ stats.medium.lot_size | format_number }}</td><td>{{ stats.high.lot_size | format_number }}</td></tr>
      <tr><td>Bedrooms</td><td>{{ stats.piq.bedrooms | default('-') }}</td><td>{{ stats.low.bedrooms | default('-') }}</td><td>{{ stats.medium.bedrooms | default('-') }}</td><td>{{ stats.high.bedrooms | default('-') }}</td></tr>
      <tr><td>Bathrooms</td><td>{{ stats.piq.bathrooms | default('-') }}</td><td>{{ stats.low.bathrooms | default('-') }}</td><td>{{ stats.medium.bathrooms | default('-') }}</td><td>{{ stats.high.bathrooms | default('-') }}</td></tr>
    </tbody>
    <tfoot>
      <tr><td>Sale Price</td><td>{{ stats.piq.price | format_currency }}</td><td>{{ stats.low.price | format_currency }}</td><td>{{ stats.medium.price | format_currency }}</td><td>{{ stats.high.price | format_currency }}</td></tr>
    </tfoot>
  </table>
  {{ macros.market_metrics_block(market_trends) }}
</div>
{{ macros.page_footer(agent, 5) }}
{% endblock %}

{# =============================================================================
   COMPARABLES PAGE OVERRIDE — Transplanted from V0 original (commit 8dbec7b)
   2x2 comp grid, navy price badge top-left, pin SVG, serif address, 4-stat cards
   ============================================================================= #}
{% block comparables %}
<div class="classic-v0-header">
  <div class="header-label">Recent Transactions</div>
  <h2 class="header-title">Sales Comparables</h2>
</div>
<div class="page-content classic-v0-p6">
  {{ macros.comp_confidence_bar(comp_confidence_grade, comp_confidence_reason, comparables|length) }}
  <div class="comp-grid">
    {% for comp in comparables[:4] %}
    <div class="comp-card">
      <div class="comp-card-image" {% if comp.photo_url or comp.map_image_url %}style="background-image: url('{{ comp.photo_url | default(comp.map_image_url) }}'); background-size: cover; background-position: center;"{% endif %}>
        <div class="comp-card-price">{{ comp.sale_price | format_currency }}</div>
      </div>
      <div class="comp-card-body">
        <div class="comp-card-address">
          <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z"/></svg>
          {{ comp.address }}
        </div>
        <div class="comp-card-stats">
          <div class="comp-stat"><div class="comp-stat-label">Sold</div><div class="comp-stat-value">{{ comp.sold_date }}</div></div>
          <div class="comp-stat"><div class="comp-stat-label">Sq.Ft.</div><div class="comp-stat-value">{{ comp.sqft | format_number }}</div></div>
          <div class="comp-stat"><div class="comp-stat-label">Bed/Bath</div><div class="comp-stat-value">{{ comp.bedrooms }}/{{ comp.bathrooms }}</div></div>
          <div class="comp-stat"><div class="comp-stat-label">$/Sq.Ft.</div><div class="comp-stat-value">{{ comp.price_per_sqft | format_currency }}</div></div>
          {% if comp.lot_display %}<div class="comp-stat"><div class="comp-stat-label">Lot</div><div class="comp-stat-value">{{ comp.lot_display }}</div></div>{% endif %}
          <div class="comp-stat"><div class="comp-stat-label">HOA</div><div class="comp-stat-value">{% if comp.hoa_fee %}{{ comp.hoa_fee | format_currency }}{% if comp.hoa_frequency %}/{{ comp.hoa_frequency }}{% endif %}{% else %}No HOA{% endif %}</div></div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{{ macros.page_footer(agent, 6) }}
{% endblock %}

{# =============================================================================
   RANGE PAGE OVERRIDE — Transplanted from V0 original (commit 8dbec7b)
   Map with rounded border, navy stat cards, sky-navy slider, white dots
   ============================================================================= #}
{% block range %}
<div class="classic-v0-header">
  <div class="header-label">Valuation Summary</div>
  <h2 class="header-title">Range of Sales</h2>
</div>
<div class="page-content classic-v0-p7">
  <div class="range-map" {% if images.aerial_map %}style="background-image: url('{{ images.aerial_map }}'); background-size: cover; background-position: center;"{% endif %}>
    {% if images.aerial_map %}<img src="{{ images.aerial_map }}" alt="Aerial map">{% endif %}
  </div>
  <div class="range-stats">
    <div class="range-stat"><div class="range-stat-num">{{ '%02d' | format(stats.total_comps | default(0)) }}</div><div class="range-stat-label">Total Comps</div></div>
    <div class="range-stat"><div class="range-stat-num">{{ stats.avg_sqft | default(0) | int }}</div><div class="range-stat-label">Avg. Sq.Ft.</div></div>
    <div class="range-stat"><div class="range-stat-num">{{ '%02d' | format(stats.avg_beds | default(0) | int) }}</div><div class="range-stat-label">Avg. Beds</div></div>
    <div class="range-stat"><div class="range-stat-num">{{ '%02d' | format(stats.avg_baths | default(0) | int) }}</div><div class="range-stat-label">Avg. Baths</div></div>
  </div>
  <div class="range-slider">
    <div class="range-slider-header">
      <div class="range-slider-price">{{ stats.price_low | format_currency_short }}</div>
      <div class="range-slider-price">{{ stats.price_high | format_currency_short }}</div>
    </div>
    <div class="range-slider-track">
      <div class="range-slider-dot" style="left: 5%;"></div>
      <div class="range-slider-dot" style="left: 95%;"></div>
    </div>
    <p class="range-note">The above statistics represent average property details for comparable homes sold within the last 12 months. The price range indicates the low and high sale prices for properties matching your home's characteristics.</p>
  </div>
</div>
{{ macros.page_footer(agent, 7) }}
{% endblock %}
