{# =============================================================================
   BOLD THEME
   Confident, powerful, modern aesthetic with gold accents
   
   Typography: Oswald (display) + Inter (body)
   Colors: Deep navy + gold
   Style: Strong geometric shapes, bold type, high contrast
   ============================================================================= #}

{% extends '_base/base.jinja2' %}

{% block fonts %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
{% endblock %}

{% block theme_styles %}
  :root {
    /* Bold Theme Colors - Primary is customizable via theme_color */
    --color-primary: {{ theme_color | default('#0F1629', true) }};
    --color-primary-light: {{ theme_color | default('#1a2744', true) }};
    --color-accent: #C9A227;
    --color-accent-light: #dbb94a;
    --color-background: #FFFFFF;
    --color-surface: #F8F7F4;
    --color-text: #0F1629;
    --color-text-muted: #64748B;
    --color-border: #E2E8F0;
    
    /* Typography */
    --font-display: 'Oswald', system-ui, sans-serif;
    --font-body: 'Inter', system-ui, sans-serif;
    
    /* Bold-specific */
    --radius-sm: 2px;
    --radius-md: 4px;
    --radius-lg: 6px;
    
    --shadow-sm: 0 2px 4px rgba(15, 22, 41, 0.08);
    --shadow-md: 0 4px 12px rgba(15, 22, 41, 0.12);
    --shadow-lg: 0 12px 40px rgba(15, 22, 41, 0.18);
    --shadow-gold: 0 6px 20px rgba(201, 162, 39, 0.25);
  }
  
  /* ==========================================================================
     BOLD: Cover Page
     ========================================================================== */
  
  .page-cover {
    background: var(--color-primary);
  }
  
  .page-cover .cover-bg {
    position: absolute;
    inset: 0;
    background: 
      linear-gradient(165deg, 
        rgba(15, 22, 41, 0.02) 0%,
        rgba(15, 22, 41, 0.25) 35%,
        rgba(15, 22, 41, 0.88) 75%,
        rgba(8, 11, 22, 0.97) 100%
      ){% if images.hero %},
      url('{{ images.hero }}') center/cover no-repeat{% endif %};
  }
  
  /* Top accent bar */
  .page-cover::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: linear-gradient(90deg, var(--color-accent) 0%, var(--color-accent) 40%, var(--color-primary) 40%);
    z-index: 10;
  }
  
  /* Branding header */
  .page-cover .cover-branding-header {
    position: absolute;
    top: var(--page-margin);
    left: var(--page-margin);
    right: var(--page-margin);
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    z-index: 5;
  }
  
  .page-cover .logo-mark {
    width: 48px;
    height: 48px;
    background: var(--color-accent);
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--font-display);
    font-weight: 700;
    font-size: 18px;
    color: var(--color-primary);
  }
  
  .page-cover .report-badge {
    background: rgba(255,255,255,0.95);
    padding: 10px 20px;
    font-family: var(--font-display);
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--color-primary);
  }
  
  /* Main content area */
  .page-cover .cover-content {
    position: absolute;
    bottom: 140px;
    left: var(--page-margin);
    right: var(--page-margin);
    z-index: 5;
  }
  
  .page-cover .cover-property-type {
    font-family: var(--font-display);
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--color-accent);
    margin-bottom: 12px;
  }
  
  .page-cover .cover-address {
    font-family: var(--font-display);
    font-size: 52px;
    font-weight: 700;
    line-height: 1.05;
    color: white;
    text-transform: uppercase;
    letter-spacing: -1px;
    margin-bottom: 16px;
    text-shadow: 0 2px 16px rgba(0,0,0,0.4);
  }
  
  .page-cover .cover-location {
    font-family: var(--font-body);
    font-size: 16px;
    font-weight: 500;
    color: rgba(255,255,255,0.8);
    letter-spacing: 0.5px;
  }
  
  .page-cover .cover-accent-line {
    width: 80px;
    height: 4px;
    background: var(--color-accent);
    margin: 24px 0;
  }
  
  .page-cover .property-stats {
    margin-top: 20px;
  }
  
  .page-cover .stat-value {
    color: white;
    font-size: 28px;
  }
  
  .page-cover .stat-label {
    color: rgba(255,255,255,0.6);
  }
  
  /* Corner accent */
  .page-cover::after {
    content: '';
    position: absolute;
    bottom: 110px;
    right: 0;
    width: 120px;
    height: 120px;
    background: var(--color-accent);
    clip-path: polygon(100% 0, 100% 100%, 0 100%);
    opacity: 0.9;
    z-index: 4;
  }
  
  /* Footer override for cover */
  .page-cover .cover-footer {
    height: 110px;
    padding: 0 var(--page-margin);
    border-top: none;
  }
  
  .page-cover .cover-agent-photo {
    border-color: var(--color-accent);
    width: 64px;
    height: 64px;
  }
  
  .page-cover .cover-agent-name {
    font-size: 18px;
    font-weight: 700;
  }
  
  /* ==========================================================================
     BOLD: Page Header Overrides
     ========================================================================== */
  
  .page-header {
    border-bottom: 3px solid var(--color-primary);
  }
  
  .page-title {
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 32px;
  }
  
  .page-header-accent {
    display: none; /* Using border instead */
  }
  
  /* ==========================================================================
     BOLD: Contents Page
     ========================================================================== */
  
  .page-contents .contents-item {
    border-bottom: 2px solid var(--color-border);
    padding: var(--space-md) 0;
  }
  
  .page-contents .contents-number {
    font-size: 18px;
    font-weight: 700;
    color: var(--color-accent);
    min-width: 40px;
  }
  
  .page-contents .contents-title {
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-size: 18px;
  }
  
  /* ==========================================================================
     BOLD: Data Tables
     ========================================================================== */
  
  .data-table tr:nth-child(odd) {
    background: var(--color-surface);
  }
  
  .data-table td {
    padding: 12px 16px;
  }
  
  .table-title {
    background: var(--color-primary);
    color: white;
    padding: 12px 16px;
    margin-bottom: 0;
  }
  
  /* ==========================================================================
     BOLD: Comp Cards
     ========================================================================== */
  
  .comp-card {
    border: 2px solid var(--color-border);
    border-radius: var(--radius-md);
  }
  
  .comp-card-header {
    background: var(--color-primary);
    padding: 12px var(--space-md);
  }
  
  .comp-price {
    font-size: 18px;
    letter-spacing: -0.5px;
  }
  
  .comp-address {
    text-transform: uppercase;
    letter-spacing: 0.3px;
  }
  
  /* ==========================================================================
     BOLD: Analysis Summary
     ========================================================================== */
  
  .analysis-summary {
    background: var(--color-surface);
    border: 2px solid var(--color-border);
    border-radius: var(--radius-md);
  }
  
  .range-value {
    letter-spacing: -1px;
  }
  
  .range-median {
    background: var(--color-primary);
    color: white;
    padding: var(--space-md);
    margin: calc(-1 * var(--space-lg));
    margin-bottom: var(--space-lg);
  }
  
  .range-median .range-label {
    color: rgba(255,255,255,0.7);
  }
  
  .range-median .range-value {
    color: var(--color-accent);
    font-size: 28px;
  }
  
  /* ==========================================================================
     BOLD: Map Card
     ========================================================================== */
  
  .map-card {
    border: 2px solid var(--color-border);
    border-radius: var(--radius-md);
  }
  
  .map-card-header {
    background: var(--color-primary);
    color: white;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  
  .map-card-image {
    height: 450px;
  }
  
  /* ==========================================================================
     BOLD: Price Range
     ========================================================================== */
  
  .price-range-track {
    height: 12px;
    background: linear-gradient(90deg, 
      var(--color-surface) 0%, 
      var(--color-accent) 35%,
      var(--color-primary) 65%,
      var(--color-surface) 100%
    );
    border-radius: 2px;
  }
  
  .price-range-marker-label {
    background: var(--color-primary);
    font-size: 14px;
    padding: 6px 14px;
  }
  
  /* Range comps list */
  .range-comps-list {
    margin-top: var(--space-xl);
    background: var(--color-surface);
    border: 2px solid var(--color-border);
  }
  
  .range-comp-item {
    display: flex;
    justify-content: space-between;
    padding: var(--space-md) var(--space-lg);
    border-bottom: 1px solid var(--color-border);
  }
  
  .range-comp-item:last-child {
    border-bottom: none;
  }
  
  .range-comp-item:nth-child(odd) {
    background: white;
  }
  
  .range-comp-address {
    font-family: var(--font-display);
    font-size: 14px;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.3px;
  }
  
  .range-comp-price {
    font-family: var(--font-display);
    font-size: 16px;
    font-weight: 700;
    color: var(--color-primary);
  }
  
  /* ==========================================================================
     BOLD: Footer Overrides
     ========================================================================== */
  
  .footer-agent-name {
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  
  /* V0 overrides — Bold */
  .section-title {
    text-transform: uppercase;
    letter-spacing: 1.5px;
  }
  
  .comparison-header {
    background: var(--color-primary);
  }
  
  .range-bar-track {
    background: linear-gradient(90deg, var(--color-surface) 0%, var(--color-accent) 100%);
  }
  
  .market-insight-title {
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  /* ==========================================================================
     BOLD: Internal Page Accents — Theme personality on pages 2-7
     ========================================================================== */

  /* Strong accent bar on internal pages */
  .page-contents::before,
  .page-aerial::before,
  .page-property::before,
  .page-analysis::before,
  .page-comparables::before,
  .page-range::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: linear-gradient(90deg, var(--color-accent) 0%, var(--color-accent) 40%, var(--color-primary) 40%);
    z-index: 10;
  }

  /* Key stats bar */
  .key-stats-bar {
    background: var(--color-primary);
  }

  /* Analysis summary — bold border */
  .analysis-summary {
    border-top: 4px solid var(--color-primary);
  }

  /* Range bar container */
  .range-bar-container {
    border-top: 4px solid var(--color-accent);
  }

  /* Stats grid cards with gold accent */
  .range-stat-card {
    border-top: 3px solid var(--color-accent);
  }

  /* Market insight */
  .market-insight {
    border-left: 4px solid var(--color-accent);
    background: var(--color-surface);
  }

  /* Comp cards — gold accent line */
  .comp-card {
    border-top: 3px solid var(--color-accent);
  }

  /* Contents sidebar accent */
  .page-contents .contents-sidebar-accent {
    width: 4px;
    background: var(--color-accent);
    opacity: 0.7;
  }

  /* ==========================================================================
     BOLD V0 PAGES 5-7: page-content must start BELOW the bold-v0-header.
     bold-v0-header is in normal flow at y=0 in .page (height ≈ 130px).
     The base .page-content is position:absolute; top:0.5in (48px), which
     places content INSIDE the header. Override top to clear the header.
     ========================================================================== */

  .page-analysis .page-content,
  .page-comparables .page-content,
  .page-range .page-content {
    top: 130px;
  }

  /* ==========================================================================
     BOLD V0 ORIGINAL: Analysis Page (p5) — Transplanted from commit 8dbec7b
     ========================================================================== */

  .bold-v0-header {
    background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
    padding: 20px 25px;
    border-bottom: 4px solid var(--color-accent);
    position: relative;
  }

  .bold-v0-header::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 25px;
    width: 60px;
    height: 4px;
    background: var(--color-accent-light);
  }

  .bold-v0-header .header-label {
    font-size: 11px;
    letter-spacing: 0.3em;
    text-transform: uppercase;
    color: var(--color-accent);
    margin-bottom: 6px;
    font-weight: 500;
  }

  .bold-v0-header .header-title {
    font-family: var(--font-display);
    font-size: 42px;
    font-weight: 700;
    color: white;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    margin: 0;
    text-shadow: 0 2px 8px rgba(0,0,0,0.2);
  }

  .bold-v0-p5 .analysis-chart {
    background: linear-gradient(180deg, var(--color-surface) 0%, #fff 100%);
    border: 2px solid var(--color-primary);
    padding: 25px;
    margin-bottom: 25px;
    box-shadow: var(--shadow-sm);
  }

  .bold-v0-p5 .chart-title {
    font-family: var(--font-display);
    font-size: 16px;
    font-weight: 600;
    color: var(--color-primary);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    text-align: center;
    margin-bottom: 25px;
  }

  .bold-v0-p5 .chart-bars {
    display: flex;
    align-items: flex-end;
    justify-content: space-around;
    height: 280px;
    padding: 0 30px;
    border-bottom: 3px solid var(--color-primary);
  }

  .bold-v0-p5 .chart-bar-wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
  }

  .bold-v0-p5 .chart-bar {
    width: 60px;
    background: linear-gradient(180deg, var(--color-accent-light) 0%, var(--color-accent) 50%, var(--color-primary) 100%);
    box-shadow: var(--shadow-gold);
    border-radius: 2px 2px 0 0;
  }

  .bold-v0-p5 .chart-bar-label {
    font-size: 11px;
    color: var(--color-text-muted);
    font-weight: 600;
  }

  .bold-v0-p5 .analysis-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
    border: 2px solid var(--color-primary);
    border-radius: 12px;
    overflow: hidden;
  }

  .bold-v0-p5 .analysis-table thead {
    background: var(--color-primary);
    color: white;
  }

  .bold-v0-p5 .analysis-table th {
    padding: 14px 12px;
    text-align: left;
    font-weight: 600;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .bold-v0-p5 .analysis-table tbody tr:nth-child(odd) {
    background: var(--color-surface);
  }

  .bold-v0-p5 .analysis-table tbody tr {
    border-bottom: 1px solid var(--color-border);
  }

  .bold-v0-p5 .analysis-table td {
    padding: 12px;
  }

  .bold-v0-p5 .analysis-table tfoot {
    background: linear-gradient(90deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
    color: var(--color-primary);
    font-weight: 700;
  }

  .bold-v0-p5 .analysis-table tfoot td {
    padding: 14px 12px;
  }

  /* ==========================================================================
     BOLD V0 ORIGINAL: Comparables Page (p6) — Transplanted from commit 8dbec7b
     ========================================================================== */

  .bold-v0-p6 .comp-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 25px;
  }

  .bold-v0-p6 .comp-card {
    border: 2px solid var(--color-primary);
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(21, 33, 110, 0.08);
  }

  .bold-v0-p6 .comp-card-image {
    height: 220px;
    background: var(--color-text-muted);
    position: relative;
  }

  .bold-v0-p6 .comp-card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .bold-v0-p6 .comp-card-price {
    position: absolute;
    top: 0;
    left: 0;
    background: var(--color-accent);
    color: var(--color-primary);
    padding: 8px 16px;
    font-family: var(--font-display);
    font-size: 18px;
    font-weight: 700;
  }

  .bold-v0-p6 .comp-card-body {
    padding: 15px;
    background: white;
  }

  .bold-v0-p6 .comp-card-address {
    font-family: var(--font-display);
    font-size: 14px;
    font-weight: 600;
    color: var(--color-primary);
    text-transform: uppercase;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .bold-v0-p6 .comp-card-address svg {
    width: 14px;
    height: 14px;
    fill: var(--color-accent);
    flex-shrink: 0;
  }

  .bold-v0-p6 .comp-card-stats {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
  }

  .bold-v0-p6 .comp-stat {
    background: var(--color-surface);
    padding: 10px;
    text-align: center;
  }

  .bold-v0-p6 .comp-stat-label {
    font-size: 9px;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 4px;
    font-weight: 600;
  }

  .bold-v0-p6 .comp-stat-value {
    font-family: var(--font-display);
    font-size: 14px;
    font-weight: 600;
    color: var(--color-primary);
  }

  /* ==========================================================================
     BOLD V0 ORIGINAL: Range Page (p7) — Transplanted from commit 8dbec7b
     ========================================================================== */

  .bold-v0-p7 .range-map {
    height: 5.0in;
    background: var(--color-border);
    border: 2px solid var(--color-primary);
    border-radius: 8px;
    margin: 25px 0;
    overflow: hidden;
  }

  .bold-v0-p7 .range-map img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .bold-v0-p7 .range-stats {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    margin-bottom: 25px;
  }

  .bold-v0-p7 .range-stat {
    background: linear-gradient(160deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
    padding: 24px 10px;
    text-align: center;
    border-radius: 8px;
    border-top: 3px solid var(--color-accent);
    box-shadow: var(--shadow-md);
  }

  .bold-v0-p7 .range-stat-num {
    font-family: var(--font-display);
    font-size: 42px;
    font-weight: 700;
    color: var(--color-accent);
    line-height: 1;
    text-shadow: 0 2px 8px rgba(0,0,0,0.2);
  }

  .bold-v0-p7 .range-stat-label {
    font-size: 10px;
    color: rgba(255,255,255,0.75);
    text-transform: uppercase;
    letter-spacing: 0.18em;
    margin-top: 10px;
  }

  .bold-v0-p7 .range-slider {
    background: var(--color-surface);
    border: 2px solid var(--color-accent);
    border-radius: 8px;
    padding: 22px 25px;
    box-shadow: var(--shadow-sm);
  }

  .bold-v0-p7 .range-slider-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 15px;
  }

  .bold-v0-p7 .range-slider-price {
    font-family: var(--font-display);
    font-size: 26px;
    font-weight: 700;
    color: var(--color-primary);
  }

  .bold-v0-p7 .range-slider-track {
    height: 12px;
    background: linear-gradient(90deg, var(--color-accent) 0%, var(--color-primary) 50%, var(--color-accent) 100%);
    border-radius: 6px;
    position: relative;
    margin-bottom: 20px;
  }

  .bold-v0-p7 .range-slider-dot {
    width: 24px;
    height: 24px;
    background: white;
    border: 4px solid var(--color-primary);
    border-radius: 50%;
    position: absolute;
    top: 50%;
    transform: translate(-50%, -50%);
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
  }

  .bold-v0-p7 .range-note {
    font-size: 12px;
    line-height: 1.7;
    color: var(--color-text-muted);
    text-align: center;
  }
{% endblock %}

{# =============================================================================
   COVER PAGE OVERRIDE
   Bold has a unique cover layout
   ============================================================================= #}
{% block cover %}
<div class="cover-bg"></div>

<div class="cover-branding-header">
  {% if agent.logo_url %}
  <img src="{{ agent.logo_url }}" alt="{{ agent.company_name }}" style="max-height: 48px; max-width: 140px; object-fit: contain;">
  {% else %}
  <div class="logo-mark">{{ agent.company_short if agent.company_short else (agent.company_name[:2] | upper if agent.company_name else 'TR') }}</div>
  {% endif %}
  <div class="report-badge">Property Report</div>
</div>

<div class="cover-content">
  <div class="cover-property-type">{{ property.property_type | default('Single Family Residence') }}</div>
  <h1 class="cover-address">{{ property.street_address }}</h1>
  <p class="cover-location">{{ property.city }}, {{ property.state }} {{ property.zip_code }}</p>
  <div class="cover-accent-line"></div>
  {{ macros.property_stats(property) }}
</div>

{{ macros.cover_agent_block(agent) }}
{% endblock %}

{# =============================================================================
   ANALYSIS PAGE OVERRIDE — Transplanted from V0 original (commit 8dbec7b)
   Navy header bar + chart with gold-navy gradient bars + analysis table
   ============================================================================= #}
{% block analysis %}
<div class="bold-v0-header">
  <div class="header-label">Market Intelligence</div>
  <h2 class="header-title">Area Sales Analysis</h2>
</div>
<div class="page-content bold-v0-p5">
  <div class="analysis-chart">
    <div class="chart-title">Recent Comparable Sales Activity</div>
    <div class="chart-bars">
      {% for comp in comparables[:4] %}
      <div class="chart-bar-wrap">
        <div class="chart-bar" style="height: {{ [40, (comp.sale_price / 8000) | int] | max }}px;"></div>
        <div class="chart-bar-label">{{ comp.sold_date | default('-') }}</div>
      </div>
      {% endfor %}
    </div>
  </div>
  <table class="analysis-table">
    <thead>
      <tr><th>Metric</th><th>Subject</th><th>Low</th><th>Medium</th><th>High</th></tr>
    </thead>
    <tbody>
      <tr><td>Distance (mi)</td><td>{{ stats.piq.distance | default('0') }}</td><td>{{ stats.low.distance | default('-') }}</td><td>{{ stats.medium.distance | default('-') }}</td><td>{{ stats.high.distance | default('-') }}</td></tr>
      <tr><td>Living Area (sf)</td><td>{{ stats.piq.sqft | default('-') }}</td><td>{{ stats.low.sqft | default('-') }}</td><td>{{ stats.medium.sqft | default('-') }}</td><td>{{ stats.high.sqft | default('-') }}</td></tr>
      <tr><td>Price/Sq.Ft.</td><td>{{ stats.piq.price_per_sqft | format_currency }}</td><td>{{ stats.low.price_per_sqft | format_currency }}</td><td>{{ stats.medium.price_per_sqft | format_currency }}</td><td>{{ stats.high.price_per_sqft | format_currency }}</td></tr>
      <tr><td>Year Built</td><td>{{ stats.piq.year_built | default('-') }}</td><td>{{ stats.low.year_built | default('-') }}</td><td>{{ stats.medium.year_built | default('-') }}</td><td>{{ stats.high.year_built | default('-') }}</td></tr>
      <tr><td>Lot Size (sf)</td><td>{{ stats.piq.lot_size | format_number }}</td><td>{{ stats.low.lot_size | format_number }}</td><td>{{ stats.medium.lot_size | format_number }}</td><td>{{ stats.high.lot_size | format_number }}</td></tr>
      <tr><td>Bedrooms</td><td>{{ stats.piq.bedrooms | default('-') }}</td><td>{{ stats.low.bedrooms | default('-') }}</td><td>{{ stats.medium.bedrooms | default('-') }}</td><td>{{ stats.high.bedrooms | default('-') }}</td></tr>
      <tr><td>Bathrooms</td><td>{{ stats.piq.bathrooms | default('-') }}</td><td>{{ stats.low.bathrooms | default('-') }}</td><td>{{ stats.medium.bathrooms | default('-') }}</td><td>{{ stats.high.bathrooms | default('-') }}</td></tr>
    </tbody>
    <tfoot>
      <tr><td>Sale Price</td><td>{{ stats.piq.price | format_currency }}</td><td>{{ stats.low.price | format_currency }}</td><td>{{ stats.medium.price | format_currency }}</td><td>{{ stats.high.price | format_currency }}</td></tr>
    </tfoot>
  </table>
  {{ macros.market_metrics_block(market_trends) }}
</div>
{{ macros.page_footer(agent, 5) }}
{% endblock %}

{# =============================================================================
   COMPARABLES PAGE OVERRIDE — Transplanted from V0 original (commit 8dbec7b)
   2x2 comp grid, gold price badge on image, pin SVG, 4-stat cards
   ============================================================================= #}
{% block comparables %}
<div class="bold-v0-header">
  <div class="header-label">Recent Transactions</div>
  <h2 class="header-title">Sales Comparables</h2>
</div>
<div class="page-content bold-v0-p6">
  {{ macros.comp_confidence_bar(comp_confidence_grade, comp_confidence_reason, comparables|length) }}
  <div class="comp-grid">
    {% for comp in comparables[:4] %}
    <div class="comp-card">
      <div class="comp-card-image" {% if comp.photo_url or comp.map_image_url %}style="background-image: url('{{ comp.photo_url | default(comp.map_image_url) }}'); background-size: cover; background-position: center;"{% endif %}>
        <div class="comp-card-price">{{ comp.sale_price | format_currency }}</div>
      </div>
      <div class="comp-card-body">
        <div class="comp-card-address">
          <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z"/></svg>
          {{ comp.address }}
        </div>
        <div class="comp-card-stats">
          <div class="comp-stat"><div class="comp-stat-label">{{ comp.sold_date_label | default('Sold') }}</div><div class="comp-stat-value">{{ comp.sold_date }}</div></div>
          <div class="comp-stat"><div class="comp-stat-label">Sq.Ft.</div><div class="comp-stat-value">{{ comp.sqft | format_number }}</div></div>
          <div class="comp-stat"><div class="comp-stat-label">Bed/Bath</div><div class="comp-stat-value">{{ comp.bedrooms }}/{{ comp.bathrooms }}</div></div>
          <div class="comp-stat"><div class="comp-stat-label">$/Sq.Ft.</div><div class="comp-stat-value">{{ comp.price_per_sqft | format_currency }}</div></div>
          {% if comp.lot_display %}<div class="comp-stat"><div class="comp-stat-label">Lot</div><div class="comp-stat-value">{{ comp.lot_display }}</div></div>{% endif %}
          <div class="comp-stat"><div class="comp-stat-label">HOA</div><div class="comp-stat-value">{% if comp.hoa_fee %}{{ comp.hoa_fee | format_currency }}{% if comp.hoa_frequency %}/{{ comp.hoa_frequency }}{% endif %}{% else %}No HOA{% endif %}</div></div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{{ macros.page_footer(agent, 6) }}
{% endblock %}

{# =============================================================================
   RANGE PAGE OVERRIDE — Transplanted from V0 original (commit 8dbec7b)
   Map with navy border, 4 navy stat cards, gold-navy gradient slider
   ============================================================================= #}
{% block range %}
<div class="bold-v0-header">
  <div class="header-label">Valuation Summary</div>
  <h2 class="header-title">Range of Sales</h2>
</div>
<div class="page-content bold-v0-p7">
  <div class="range-map" {% if images.aerial_map %}style="background-image: url('{{ images.aerial_map }}'); background-size: cover; background-position: center;"{% endif %}>
    {% if images.aerial_map %}<img src="{{ images.aerial_map }}" alt="Aerial map">{% endif %}
  </div>
  <div class="range-stats">
    <div class="range-stat"><div class="range-stat-num">{{ '%02d' | format(stats.total_comps | default(0)) }}</div><div class="range-stat-label">Total Comps</div></div>
    <div class="range-stat"><div class="range-stat-num">{{ stats.avg_sqft | default(0) | int }}</div><div class="range-stat-label">Avg. Sq.Ft.</div></div>
    <div class="range-stat"><div class="range-stat-num">{{ '%02d' | format(stats.avg_beds | default(0) | int) }}</div><div class="range-stat-label">Avg. Beds</div></div>
    <div class="range-stat"><div class="range-stat-num">{{ '%02d' | format(stats.avg_baths | default(0) | int) }}</div><div class="range-stat-label">Avg. Baths</div></div>
  </div>
  <div class="range-slider">
    <div class="range-slider-header">
      <div class="range-slider-price">{{ stats.price_low | format_currency_short }}</div>
      <div class="range-slider-price">{{ stats.price_high | format_currency_short }}</div>
    </div>
    <div class="range-slider-track">
      <div class="range-slider-dot" style="left: 5%;"></div>
      <div class="range-slider-dot" style="left: 95%;"></div>
    </div>
    <p class="range-note">The above statistics represent average property details for comparable homes sold within the last 12 months. The price range indicates the low and high sale prices for properties matching your home's characteristics.</p>
  </div>
</div>
{{ macros.page_footer(agent, 7) }}
{% endblock %}
