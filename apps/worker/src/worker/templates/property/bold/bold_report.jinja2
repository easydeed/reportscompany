<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sellers Report - Bold Theme</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Primary accent color - can be overridden by theme_color */
      --navy: {{ theme_color | default('#15216E') }};
      --navy-light: #1E2D8F;
      --gold: #D69649;
      --gold-light: #E5AB5E;
      --cream: #FDF8F3;
      --warm-white: #FFFFFF;
      --charcoal: #1A1A1A;
      --slate: #4A4A4A;
      --border: #E8E4DF;
      --page-w: 8.5in;
      --page-h: 11in;
      --pad: 0.5in;
      --shadow: 0 8px 30px rgba(21, 33, 110, 0.15);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Montserrat', sans-serif;
      background: #2A2A2A;
      color: var(--charcoal);
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }
    @page { size: Letter; margin: 0; }
    @media print {
      body { background: #fff; }
      .sheet { padding: 0; gap: 0; }
      .page { margin: 0; box-shadow: none; }
      .page:last-child { page-break-after: avoid; }
    }
    .sheet {
      display: block;
      width: var(--page-w);
      margin: 0 auto;
      padding: 16px 0 50px;
    }
    @media print {
      .sheet { padding: 0; margin: 0; }
    }
    @media screen {
      .sheet {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 20px;
        width: auto;
      }
    }
    .page {
      width: var(--page-w);
      height: var(--page-h);
      background: var(--warm-white);
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
      page-break-after: always;
      page-break-inside: avoid;
      margin: 0 auto 20px;
    }
    @media print {
      .page { margin: 0; border-radius: 0; box-shadow: none; }
    }
    .page:last-child { page-break-after: auto; margin-bottom: 0; }
    .page.cover { padding-top: 0; }
    .font-display { font-family: 'Oswald', sans-serif; }
    .accent-line {
      height: 5px;
      background: var(--gold);
      position: relative;
    }
    .accent-line::after {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 60%;
      height: 100%;
      background: var(--navy);
    }

    /* COVER */
    .cover { 
      background: var(--navy); 
      display: flex; 
      flex-direction: column;
      position: relative;
    }
    .cover-bg-image {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      opacity: 0.15;
    }
    .cover-header {
      padding: 0.35in var(--pad);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      z-index: 2;
    }
    .cover-brand {
      font-family: 'Oswald', sans-serif;
      font-size: 28px;
      font-weight: 700;
      color: var(--warm-white);
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }
    .cover-contact {
      display: flex;
      gap: 25px;
      color: var(--gold);
      font-size: 12px;
      letter-spacing: 0.05em;
    }
    .cover-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 0 1in;
      position: relative;
      z-index: 2;
    }
    .cover-label {
      font-size: 14px;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: var(--gold);
      margin-bottom: 25px;
      font-weight: 500;
    }
    .cover-title {
      font-family: 'Oswald', sans-serif;
      font-size: 72px;
      font-weight: 700;
      color: var(--warm-white);
      line-height: 0.95;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 15px;
    }
    .cover-title span {
      color: var(--gold);
    }
    .cover-divider {
      width: 120px;
      height: 4px;
      background: var(--gold);
      margin: 30px auto;
    }
    .cover-address {
      text-align: center;
    }
    .cover-street {
      font-family: 'Oswald', sans-serif;
      font-size: 32px;
      font-weight: 600;
      color: var(--warm-white);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 10px;
    }
    .cover-city {
      font-size: 16px;
      color: rgba(255,255,255,0.7);
      letter-spacing: 0.15em;
      text-transform: uppercase;
    }
    .cover-bottom {
      background: var(--warm-white);
      padding: 0.4in var(--pad);
      display: flex;
      align-items: center;
      gap: 25px;
    }
    .cover-agent-photo {
      width: 80px;
      height: 80px;
      background: var(--navy);
      overflow: hidden;
      flex-shrink: 0;
    }
    .cover-agent-photo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .cover-agent-info {
      flex: 1;
    }
    .cover-agent-name {
      font-family: 'Oswald', sans-serif;
      font-size: 24px;
      font-weight: 600;
      color: var(--navy);
      text-transform: uppercase;
      margin-bottom: 4px;
    }
    .cover-agent-title {
      font-size: 13px;
      color: var(--gold);
      font-weight: 600;
      margin-bottom: 8px;
    }
    .cover-agent-details {
      display: flex;
      gap: 20px;
      font-size: 12px;
      color: var(--slate);
    }
    .cover-logo {
      text-align: right;
    }
    .cover-logo-text {
      font-family: 'Oswald', sans-serif;
      font-size: 18px;
      font-weight: 600;
      color: var(--navy);
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }
    .cover-logo-sub {
      font-size: 10px;
      color: var(--gold);
      letter-spacing: 0.1em;
      text-transform: uppercase;
    }

    /* CONTENTS */
    .contents { background: var(--warm-white); padding: var(--pad); }
    .page-header {
      background: var(--navy);
      padding: 20px 25px;
      margin: -var(--pad);
      margin-bottom: 30px;
    }
    .page-header-label {
      font-size: 11px;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      color: var(--gold);
      margin-bottom: 8px;
      font-weight: 500;
    }
    .page-header-title {
      font-family: 'Oswald', sans-serif;
      font-size: 42px;
      font-weight: 600;
      color: var(--warm-white);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    .contents-list {
      margin-top: 40px;
      padding: 0 20px;
    }
    .contents-item {
      display: flex;
      align-items: center;
      padding: 18px 0;
      border-bottom: 2px solid var(--border);
    }
    .contents-item:last-child {
      border-bottom: none;
    }
    .contents-num {
      font-family: 'Oswald', sans-serif;
      font-size: 36px;
      font-weight: 700;
      color: var(--navy);
      width: 60px;
    }
    .contents-text {
      flex: 1;
      font-size: 15px;
      color: var(--charcoal);
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    .contents-dots {
      flex: 1;
      border-bottom: 2px dotted var(--gold);
      margin: 0 20px;
      transform: translateY(-5px);
    }
    .contents-page {
      font-family: 'Oswald', sans-serif;
      font-size: 22px;
      font-weight: 600;
      color: var(--gold);
    }

    /* AERIAL */
    .aerial { background: var(--warm-white); }
    .aerial-header {
      background: var(--navy);
      padding: 0.4in var(--pad);
    }
    .aerial-map {
      height: 6.5in;
      background: #ddd;
      position: relative;
    }
    .aerial-map img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .aerial-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(0deg, rgba(21,33,110,0.95), transparent);
      padding: 35px var(--pad);
    }
    .aerial-cards {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .aerial-card {
      background: var(--warm-white);
      padding: 20px;
      border-left: 4px solid var(--gold);
    }
    .aerial-card h3 {
      font-family: 'Oswald', sans-serif;
      font-size: 15px;
      font-weight: 600;
      color: var(--navy);
      text-transform: uppercase;
      margin-bottom: 8px;
    }
    .aerial-card p {
      font-size: 12px;
      line-height: 1.6;
      color: var(--slate);
    }

    /* PROPERTY */
    .property { background: var(--warm-white); padding: var(--pad); }
    .property-section {
      margin-bottom: 20px;
    }
    .property-section-header {
      background: var(--navy);
      color: var(--warm-white);
      padding: 12px 18px;
      font-family: 'Oswald', sans-serif;
      font-size: 14px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 0;
    }
    .property-table {
      width: 100%;
      border-collapse: collapse;
      border: 2px solid var(--navy);
      border-top: none;
      border-radius: 0 0 10px 10px;
      overflow: hidden;
    }
    .property-table tr:nth-child(odd) {
      background: var(--cream);
    }
    .property-table td {
      padding: 12px 18px;
      font-size: 13px;
      border-bottom: 1px solid var(--border);
    }
    .property-table td:first-child {
      color: var(--slate);
      width: 45%;
      font-weight: 500;
    }
    .property-table td:last-child {
      color: var(--charcoal);
      font-weight: 600;
    }
    .property-section-header {
      border-radius: 10px 10px 0 0;
    }
    .property-two-col {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    /* ANALYSIS */
    .analysis { background: var(--warm-white); padding: var(--pad); }
    .analysis-chart {
      background: var(--cream);
      border: 2px solid var(--navy);
      padding: 25px;
      margin-bottom: 25px;
    }
    .chart-title {
      font-family: 'Oswald', sans-serif;
      font-size: 16px;
      font-weight: 600;
      color: var(--navy);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      text-align: center;
      margin-bottom: 25px;
    }
    .chart-bars {
      display: flex;
      align-items: flex-end;
      justify-content: space-around;
      height: 150px;
      padding: 0 30px;
      border-bottom: 3px solid var(--navy);
    }
    .chart-bar-wrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }
    .chart-bar {
      width: 60px;
      background: linear-gradient(180deg, var(--gold) 0%, var(--navy) 100%);
    }
    .chart-bar-label {
      font-size: 11px;
      color: var(--slate);
      font-weight: 600;
    }
    .analysis-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      border: 2px solid var(--navy);
      border-radius: 12px;
      overflow: hidden;
    }
    .analysis-table thead {
      background: var(--navy);
      color: var(--warm-white);
    }
    .analysis-table th {
      padding: 14px 12px;
      text-align: left;
      font-weight: 600;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    .analysis-table tbody tr:nth-child(odd) {
      background: var(--cream);
    }
    .analysis-table tbody tr {
      border-bottom: 1px solid var(--border);
    }
    .analysis-table td {
      padding: 12px;
    }
    .analysis-table tfoot {
      background: var(--gold);
      color: var(--navy);
      font-weight: 700;
    }
    .analysis-table tfoot td {
      padding: 14px 12px;
    }

    /* COMPARABLES */
    .comparables { background: var(--warm-white); padding: var(--pad); }
    .comp-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 25px;
    }
    .comp-card {
      border: 2px solid var(--navy);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(21, 33, 110, 0.08);
    }
    .comp-card-image {
      height: 130px;
      background: var(--slate);
      position: relative;
    }
    .comp-card-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .comp-card-price {
      position: absolute;
      top: 0;
      left: 0;
      background: var(--gold);
      color: var(--navy);
      padding: 8px 16px;
      font-family: 'Oswald', sans-serif;
      font-size: 18px;
      font-weight: 700;
    }
    .comp-card-body {
      padding: 15px;
      background: var(--warm-white);
    }
    .comp-card-address {
      font-family: 'Oswald', sans-serif;
      font-size: 14px;
      font-weight: 600;
      color: var(--navy);
      text-transform: uppercase;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .comp-card-address svg {
      width: 14px;
      height: 14px;
      fill: var(--gold);
      flex-shrink: 0;
    }
    .comp-card-stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
    }
    .comp-stat {
      background: var(--cream);
      padding: 10px;
      text-align: center;
    }
    .comp-stat-label {
      font-size: 9px;
      color: var(--slate);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 4px;
      font-weight: 600;
    }
    .comp-stat-value {
      font-family: 'Oswald', sans-serif;
      font-size: 14px;
      font-weight: 600;
      color: var(--navy);
    }

    /* RANGE */
    .range { background: var(--warm-white); padding: var(--pad); }
    .range-map {
      height: 3.8in;
      background: var(--border);
      border: 2px solid var(--navy);
      border-radius: 8px;
      margin: 25px 0;
      overflow: hidden;
    }
    .range-map img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .range-stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin-bottom: 25px;
    }
    .range-stat {
      background: var(--navy);
      padding: 28px 10px;
      text-align: center;
      border-radius: 8px;
    }
    .range-stat-num {
      font-family: 'Oswald', sans-serif;
      font-size: 42px;
      font-weight: 700;
      color: var(--gold);
      line-height: 1;
    }
    .range-stat-label {
      font-size: 10px;
      color: rgba(255,255,255,0.8);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      margin-top: 10px;
    }
    .range-slider {
      background: var(--cream);
      border: 2px solid var(--gold);
      border-radius: 12px;
      padding: 25px;
    }
    .range-slider-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
    }
    .range-slider-price {
      font-family: 'Oswald', sans-serif;
      font-size: 26px;
      font-weight: 700;
      color: var(--navy);
    }
    .range-slider-track {
      height: 12px;
      background: linear-gradient(90deg, var(--gold) 0%, var(--navy) 50%, var(--gold) 100%);
      border-radius: 6px;
      position: relative;
      margin-bottom: 20px;
    }
    .range-slider-dot {
      width: 24px;
      height: 24px;
      background: var(--warm-white);
      border: 4px solid var(--navy);
      border-radius: 50%;
      position: absolute;
      top: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    .range-note {
      font-size: 12px;
      line-height: 1.7;
      color: var(--slate);
      text-align: center;
    }

    /* Page Footer */
    .page-footer {
      position: absolute;
      bottom: 0.4in;
      left: var(--pad);
      right: var(--pad);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 12px;
      border-top: 2px solid var(--navy);
    }
    .page-footer .brand {
      font-size: 10px;
      color: var(--gold);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      font-weight: 600;
    }
    .page-footer .num {
      font-family: 'Oswald', sans-serif;
      font-size: 18px;
      font-weight: 700;
      color: var(--navy);
    }
  </style>
</head>
<body>
  <div class="sheet">

    <!-- PAGE 1: COVER -->
    <section class="page cover">
      {% if images.hero %}<div class="cover-bg-image" style="background-image: url('{{ images.hero }}');"></div>{% endif %}
      <div class="cover-header">
        <div class="cover-brand">{{ agent.company_name | default('TrendyReports') }}</div>
        <div class="cover-contact">
          <span>☎ {{ agent.phone | default('(000) 000-0000') }}</span>
          <span>✉ {{ agent.email | default('info@example.com') }}</span>
        </div>
      </div>

      <div class="cover-main">
        <div class="cover-label">Comprehensive Property Analysis</div>
        <h1 class="cover-title">Seller's<br><span>Report</span></h1>
        <div class="cover-divider"></div>
        <div class="cover-address">
          <div class="cover-street">{{ property.street_address }}</div>
          <div class="cover-city">{{ property.city }}, {{ property.state }} {{ property.zip_code }}</div>
        </div>
      </div>

      <div class="cover-bottom">
        <div class="cover-agent-photo">
          {% if agent.photo_url %}<img src="{{ agent.photo_url }}" alt="{{ agent.name }} headshot" />{% endif %}
        </div>
        <div class="cover-agent-info">
          <div class="cover-agent-name">{{ agent.name }}</div>
          <div class="cover-agent-title">{{ agent.title | default('Licensed Real Estate Agent') }} • {{ agent.license | default('') }}</div>
          <div class="cover-agent-details">
            <span>☎ {{ agent.phone | default('(000) 000-0000') }}</span>
            <span>✉ {{ agent.email | default('agent@example.com') }}</span>
          </div>
        </div>
        <div class="cover-logo">
          <div class="cover-logo-text">{{ agent.company_name | default('REALTY GROUP') }}</div>
          <div class="cover-logo-sub">{{ agent.company_tagline | default('Excellence in Real Estate') }}</div>
        </div>
      </div>
    </section>

    <!-- PAGE 2: CONTENTS -->
    <section class="page contents">
      <div class="page-header">
        <div class="page-header-label">Report Overview</div>
        <h2 class="page-header-title">Contents</h2>
      </div>
      <div class="contents-list">
        <div class="contents-item"><div class="contents-num">01</div><div class="contents-text">Aerial Property View</div><div class="contents-dots"></div><div class="contents-page">03</div></div>
        <div class="contents-item"><div class="contents-num">02</div><div class="contents-text">Property Information</div><div class="contents-dots"></div><div class="contents-page">04</div></div>
        <div class="contents-item"><div class="contents-num">03</div><div class="contents-text">Area Sales Analysis</div><div class="contents-dots"></div><div class="contents-page">05</div></div>
        <div class="contents-item"><div class="contents-num">04</div><div class="contents-text">Sales Comparables</div><div class="contents-dots"></div><div class="contents-page">06</div></div>
        <div class="contents-item"><div class="contents-num">05</div><div class="contents-text">Estimated Value Range</div><div class="contents-dots"></div><div class="contents-page">07</div></div>
      </div>
      <div class="page-footer"><div class="brand">Bold Collection • TrendyReports</div><div class="num">02</div></div>
    </section>

    <!-- PAGE 3: AERIAL -->
    <section class="page aerial">
      <div class="aerial-header">
        <div class="page-header-label">Location Overview</div>
        <h2 class="page-header-title">Aerial View</h2>
      </div>
      <div class="aerial-map" {% if images.aerial_map %}style="background-image: url('{{ images.aerial_map }}'); background-size: cover; background-position: center;"{% endif %}>
        <div class="aerial-overlay">
          <div class="aerial-cards">
            <div class="aerial-card">
              <h3>Neighborhood Context</h3>
              <p>This aerial view showcases your property's prime location within the neighborhood, highlighting proximity to parks, schools, and major thoroughfares.</p>
            </div>
            <div class="aerial-card">
              <h3>Quarter-Mile Radius</h3>
              <p>Properties within this radius provide the most accurate comparables, sharing similar neighborhood characteristics and market dynamics.</p>
            </div>
          </div>
        </div>
      </div>
      <div class="page-footer" style="border-color: rgba(255,255,255,.2);"><div class="brand" style="color:var(--gold);">Bold Collection • TrendyReports</div><div class="num" style="color:#fff;">03</div></div>
    </section>

    <!-- PAGE 4: PROPERTY -->
    <section class="page property">
      <div class="page-header">
        <div class="page-header-label">Property Overview</div>
        <h2 class="page-header-title">Prospective Property</h2>
      </div>
      <div class="property-two-col">
        <div>
          <div class="property-section">
            <div class="property-section-header">Owner Information</div>
            <table class="property-table">
              <tr><td>Primary Owner</td><td>{{ property.owner_name | default('-') }}</td></tr>
              <tr><td>Secondary Owner</td><td>{{ property.secondary_owner | default('-') }}</td></tr>
              <tr><td>Site Address</td><td>{{ property.full_address }}</td></tr>
              <tr><td>Mailing Address</td><td>{{ property.mailing_address | default(property.full_address) }}</td></tr>
            </table>
          </div>
          <div class="property-section">
            <div class="property-section-header">Tax & Assessment</div>
            <table class="property-table">
              <tr><td>Assessed Value</td><td>{{ property.assessed_value | format_currency }}</td></tr>
              <tr><td>Land Value</td><td>{{ property.land_value | format_currency }}</td></tr>
              <tr><td>Annual Tax</td><td>{{ property.tax_amount | format_currency }}</td></tr>
              <tr><td>Tax Year</td><td>{{ property.tax_year | default('-') }}</td></tr>
            </table>
          </div>
        </div>
        <div>
          <div class="property-section">
            <div class="property-section-header">Legal Information</div>
            <table class="property-table">
              <tr><td>APN</td><td>{{ property.apn | default('-') }}</td></tr>
              <tr><td>County</td><td>{{ property.county | default('-') }}</td></tr>
              <tr><td>Census Tract</td><td>{{ property.census_tract | default('-') }}</td></tr>
              <tr><td>Legal Description</td><td>{{ property.legal_description | default('-') }}</td></tr>
            </table>
          </div>
          <div class="property-section">
            <div class="property-section-header">Property Details</div>
            <table class="property-table">
              <tr><td>Bedrooms</td><td>{{ property.bedrooms | default('-') }}</td></tr>
              <tr><td>Bathrooms</td><td>{{ property.bathrooms | default('-') }}</td></tr>
              <tr><td>Square Feet</td><td>{{ property.sqft | default('-') | int | format_number }}</td></tr>
              <tr><td>Lot Size</td><td>{{ property.lot_size | default('-') | int | format_number }} sq ft</td></tr>
              <tr><td>Year Built</td><td>{{ property.year_built | default('-') }}</td></tr>
              <tr><td>Property Type</td><td>{{ property.property_type | default('Single Family') }}</td></tr>
            </table>
          </div>
        </div>
      </div>
      <div class="page-footer"><div class="brand">Bold Collection • TrendyReports</div><div class="num">04</div></div>
    </section>

    <!-- PAGE 5: ANALYSIS -->
    <section class="page analysis">
      <div class="page-header">
        <div class="page-header-label">Market Intelligence</div>
        <h2 class="page-header-title">Area Sales Analysis</h2>
      </div>
      <div class="analysis-chart">
        <div class="chart-title">Recent Comparable Sales Activity</div>
        <div class="chart-bars">
          {% for comp in comparables[:4] %}
          <div class="chart-bar-wrap">
            <div class="chart-bar" style="height: {{ [40, (comp.sale_price / 8000) | int] | max }}px;"></div>
            <div class="chart-bar-label">{{ comp.sold_date | default('-') }}</div>
          </div>
          {% endfor %}
        </div>
      </div>
      <table class="analysis-table">
        <thead>
          <tr><th>Metric</th><th>Subject</th><th>Low</th><th>Medium</th><th>High</th></tr>
        </thead>
        <tbody>
          <tr><td>Distance (mi)</td><td>{{ stats.piq.distance | default('0') }}</td><td>{{ stats.low.distance | default('-') }}</td><td>{{ stats.medium.distance | default('-') }}</td><td>{{ stats.high.distance | default('-') }}</td></tr>
          <tr><td>Living Area (sf)</td><td>{{ stats.piq.sqft | default('-') }}</td><td>{{ stats.low.sqft | default('-') }}</td><td>{{ stats.medium.sqft | default('-') }}</td><td>{{ stats.high.sqft | default('-') }}</td></tr>
          <tr><td>Price/Sq.Ft.</td><td>{{ stats.piq.price_per_sqft | format_currency }}</td><td>{{ stats.low.price_per_sqft | format_currency }}</td><td>{{ stats.medium.price_per_sqft | format_currency }}</td><td>{{ stats.high.price_per_sqft | format_currency }}</td></tr>
          <tr><td>Year Built</td><td>{{ stats.piq.year_built | default('-') }}</td><td>{{ stats.low.year_built | default('-') }}</td><td>{{ stats.medium.year_built | default('-') }}</td><td>{{ stats.high.year_built | default('-') }}</td></tr>
          <tr><td>Lot Size (sf)</td><td>{{ stats.piq.lot_size | format_number }}</td><td>{{ stats.low.lot_size | format_number }}</td><td>{{ stats.medium.lot_size | format_number }}</td><td>{{ stats.high.lot_size | format_number }}</td></tr>
          <tr><td>Bedrooms</td><td>{{ stats.piq.bedrooms | default('-') }}</td><td>{{ stats.low.bedrooms | default('-') }}</td><td>{{ stats.medium.bedrooms | default('-') }}</td><td>{{ stats.high.bedrooms | default('-') }}</td></tr>
          <tr><td>Bathrooms</td><td>{{ stats.piq.bathrooms | default('-') }}</td><td>{{ stats.low.bathrooms | default('-') }}</td><td>{{ stats.medium.bathrooms | default('-') }}</td><td>{{ stats.high.bathrooms | default('-') }}</td></tr>
        </tbody>
        <tfoot>
          <tr><td>Sale Price</td><td>{{ stats.piq.price | format_currency }}</td><td>{{ stats.low.price | format_currency }}</td><td>{{ stats.medium.price | format_currency }}</td><td>{{ stats.high.price | format_currency }}</td></tr>
        </tfoot>
      </table>
      <div class="page-footer"><div class="brand">Bold Collection • TrendyReports</div><div class="num">05</div></div>
    </section>

    <!-- PAGE 6: COMPARABLES -->
    <section class="page comparables">
      <div class="page-header">
        <div class="page-header-label">Recent Transactions</div>
        <h2 class="page-header-title">Sales Comparables</h2>
      </div>
      <div class="comp-grid">
        {% for comp in comparables[:4] %}
        <div class="comp-card">
          <div class="comp-card-image" {% if comp.map_image_url %}style="background-image: url('{{ comp.map_image_url }}'); background-size: cover; background-position: center;"{% endif %}>
            <div class="comp-card-price">{{ comp.sale_price | format_currency }}</div>
          </div>
          <div class="comp-card-body">
            <div class="comp-card-address">
              <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z"/></svg>
              {{ comp.address }}
            </div>
            <div class="comp-card-stats">
              <div class="comp-stat"><div class="comp-stat-label">Sold</div><div class="comp-stat-value">{{ comp.sold_date }}</div></div>
              <div class="comp-stat"><div class="comp-stat-label">Sq.Ft.</div><div class="comp-stat-value">{{ comp.sqft | format_number }}</div></div>
              <div class="comp-stat"><div class="comp-stat-label">Bed/Bath</div><div class="comp-stat-value">{{ comp.bedrooms }}/{{ comp.bathrooms }}</div></div>
              <div class="comp-stat"><div class="comp-stat-label">$/Sq.Ft.</div><div class="comp-stat-value">{{ comp.price_per_sqft | format_currency }}</div></div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
      <div class="page-footer"><div class="brand">Bold Collection • TrendyReports</div><div class="num">06</div></div>
    </section>

    <!-- PAGE 7: RANGE -->
    <section class="page range">
      <div class="page-header">
        <div class="page-header-label">Valuation Summary</div>
        <h2 class="page-header-title">Range of Sales</h2>
      </div>
      <div class="range-map" {% if images.aerial_map %}style="background-image: url('{{ images.aerial_map }}'); background-size: cover; background-position: center;"{% endif %}></div>
      <div class="range-stats">
        <div class="range-stat"><div class="range-stat-num">{{ '%02d' | format(stats.total_comps | default(0)) }}</div><div class="range-stat-label">Total Comps</div></div>
        <div class="range-stat"><div class="range-stat-num">{{ stats.avg_sqft | default(0) | int }}</div><div class="range-stat-label">Avg. Sq.Ft.</div></div>
        <div class="range-stat"><div class="range-stat-num">{{ '%02d' | format(stats.avg_beds | default(0) | int) }}</div><div class="range-stat-label">Avg. Beds</div></div>
        <div class="range-stat"><div class="range-stat-num">{{ '%02d' | format(stats.avg_baths | default(0) | int) }}</div><div class="range-stat-label">Avg. Baths</div></div>
      </div>
      <div class="range-slider">
        <div class="range-slider-header">
          <div class="range-slider-price">{{ stats.price_low | format_currency_short }}</div>
          <div class="range-slider-price">{{ stats.price_high | format_currency_short }}</div>
        </div>
        <div class="range-slider-track">
          <div class="range-slider-dot" style="left: 5%;"></div>
          <div class="range-slider-dot" style="left: 95%;"></div>
        </div>
        <p class="range-note">The above statistics represent average property details for comparable homes sold within the last 12 months. The price range indicates the low and high sale prices for properties matching your home's characteristics.</p>
      </div>
      <div class="page-footer"><div class="brand">Bold Collection • TrendyReports</div><div class="num">07</div></div>
    </section>

  </div>
</body>
</html>

