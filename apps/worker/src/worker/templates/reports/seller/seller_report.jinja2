{#
    Seller Report - Master Template
    ================================
    This template orchestrates the complete seller report PDF by:
    1. Selecting the appropriate theme base CSS (1-5)
    2. Including all page templates in order
    3. Supporting configurable page sets (full vs compact)

    THEME SELECTION:
    ----------------
    Pass theme_number (1-5) to select the visual theme:
    - 1: Classic (Bariol/Nexa fonts, navy accents, underlined headers)
    - 2: Modern (Montserrat, orange accents, hero images)
    - 3: Elegant (Crimson Text/Open Sans, gradient overlays)
    - 4: Teal (System fonts, teal accent, 9-page compact)
    - 5: Bold (Bebas Neue, navy/gold, 9-page compact)

    PAGE SETS:
    ----------
    - "full" (default): All 21 pages
    - "compact": 9-page version (themes 4 & 5)
    - Custom array: ["cover", "contents", "aerial", ...] for specific pages

    Required variables:
    - theme_number              : Theme 1-5 (default: 1)
    - theme_color               : Hex color for theme accents (default varies by theme)
    - assets_base_url           : Base URL for static assets (e.g., "https://r2.trendyreports.com")
    - google_maps_api_key       : Google Maps API key for aerial and comparable maps

    - property                  : Property object
    - agent                     : Agent object
    - comparables               : Array of comparable properties
    - neighborhood              : Neighborhood statistics object
    - range_of_sales            : Range of sales statistics object

    - page_set                  : "full", "compact", or array of page identifiers
#}

{# ============================================================================
   THEME BASE SELECTION
   ============================================================================ #}
{% set theme_bases = {
    1: 'bases/theme_1_classic.jinja2',
    2: 'bases/theme_2_modern.jinja2',
    3: 'bases/theme_3_elegant.jinja2',
    4: 'bases/theme_4_teal.jinja2',
    5: 'bases/theme_5_bold.jinja2'
} %}

{% set selected_theme = theme_number | default(1) | int %}
{% set theme_base = theme_bases[selected_theme] | default(theme_bases[1]) %}

{# Theme-specific default colors #}
{% set theme_default_colors = {
    1: '#0d294b',
    2: '#f2964a',
    3: '#0d294b',
    4: '#16d3ba',
    5: '#d79547'
} %}

{# Use provided theme_color or fall back to theme default #}
{% set effective_theme_color = theme_color | default(theme_default_colors[selected_theme]) %}

{# ============================================================================
   PAGE SET CONFIGURATION
   ============================================================================ #}

{# Full 21-page report #}
{% set full_pages = [
    "cover",
    "contents",
    "introduction",
    "aerial",
    "property_details",
    "area_analysis",
    "comparables",
    "range_of_sales",
    "neighborhood",
    "roadmap",
    "how_buyers_find",
    "pricing_correctly",
    "avg_days_market",
    "marketing_online",
    "marketing_print",
    "marketing_social",
    "analyze_optimize",
    "negotiating",
    "typical_transaction",
    "promise",
    "back_cover"
] %}

{# Compact 9-page report (for themes 4 & 5) #}
{% set compact_pages = [
    "cover",
    "introduction",
    "aerial",
    "property_details",
    "comparables",
    "pricing_correctly",
    "marketing_online",
    "promise",
    "back_cover"
] %}

{# Determine active pages based on page_set #}
{% if page_set is defined %}
    {% if page_set == 'full' %}
        {% set active_pages = full_pages %}
    {% elif page_set == 'compact' %}
        {% set active_pages = compact_pages %}
    {% elif page_set is iterable and page_set is not string %}
        {% set active_pages = page_set %}
    {% else %}
        {% set active_pages = full_pages %}
    {% endif %}
{% else %}
    {# Themes 4 and 5 default to compact, others to full #}
    {% if selected_theme in [4, 5] %}
        {% set active_pages = compact_pages %}
    {% else %}
        {% set active_pages = full_pages %}
    {% endif %}
{% endif %}

{# ============================================================================
   EXTEND THEME BASE AND RENDER CONTENT
   ============================================================================ #}
{% extends theme_base %}

{% block title %}Seller Report{% endblock %}

{% block content %}
    {# Override theme_color for child templates #}
    {% set theme_color = effective_theme_color %}

    {# Include each page template based on active_pages configuration #}

    {% if "cover" in active_pages %}
        {% include "seller_cover.jinja2" %}
    {% endif %}

    {% if "contents" in active_pages %}
        {% include "seller_contents.jinja2" %}
    {% endif %}

    {% if "introduction" in active_pages %}
        {% include "seller_introduction.jinja2" %}
    {% endif %}

    {% if "aerial" in active_pages %}
        {% include "seller_aerial.jinja2" %}
    {% endif %}

    {% if "property_details" in active_pages %}
        {% include "seller_property_details.jinja2" %}
    {% endif %}

    {% if "area_analysis" in active_pages %}
        {% include "seller_area_analysis.jinja2" %}
    {% endif %}

    {% if "comparables" in active_pages %}
        {% include "seller_comparables.jinja2" %}
    {% endif %}

    {% if "range_of_sales" in active_pages %}
        {% include "seller_range_of_sales.jinja2" %}
    {% endif %}

    {% if "neighborhood" in active_pages %}
        {% include "seller_neighborhood.jinja2" %}
    {% endif %}

    {% if "roadmap" in active_pages %}
        {% include "seller_roadmap.jinja2" %}
    {% endif %}

    {% if "how_buyers_find" in active_pages %}
        {% include "seller_how_buyers_find.jinja2" %}
    {% endif %}

    {% if "pricing_correctly" in active_pages %}
        {% include "seller_pricing_correctly.jinja2" %}
    {% endif %}

    {% if "avg_days_market" in active_pages %}
        {% include "seller_avg_days_market.jinja2" %}
    {% endif %}

    {% if "marketing_online" in active_pages %}
        {% include "seller_marketing_online.jinja2" %}
    {% endif %}

    {% if "marketing_print" in active_pages %}
        {% include "seller_marketing_print.jinja2" %}
    {% endif %}

    {% if "marketing_social" in active_pages %}
        {% include "seller_marketing_social.jinja2" %}
    {% endif %}

    {% if "analyze_optimize" in active_pages %}
        {% include "seller_analyze_optimize.jinja2" %}
    {% endif %}

    {% if "negotiating" in active_pages %}
        {% include "seller_negotiating.jinja2" %}
    {% endif %}

    {% if "typical_transaction" in active_pages %}
        {% include "seller_typical_transaction.jinja2" %}
    {% endif %}

    {% if "promise" in active_pages %}
        {% include "seller_promise.jinja2" %}
    {% endif %}

    {% if "back_cover" in active_pages %}
        {% include "seller_back_cover.jinja2" %}
    {% endif %}

{% endblock %}
